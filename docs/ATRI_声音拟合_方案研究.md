# ATRI 声音拟合 - GPT-SoVITS v4 超高质量方案

> 整理于 2025-12-27 | 硬件: 2x RTX 3090 (48GB VRAM)

---

## 核心原则
**数据质量 > 训练时长 > 参数调优**

---

## 第一步：数据预处理（重中之重）

### 1.1 音频切片
- **时长要求**: 2-15s，最佳 5s 左右
- **工具**: WebUI 自带 Slicer 或 `audio-slicer`

### 1.2 ASR 标注
- **推荐**: Faster-Whisper (large-v3)
- **校验重点**:
  - 多音字、口癖（嗯、啊）
  - 数字符号转文字
  - 删除乱码和过短/过长句子

### 1.3 质量筛选
- **信噪比 (SNR)**: 剔除背景噪音明显的片段
- **动态范围**: 保留语调起伏自然的音频
- **每个情感分类保留 30-50 条"天花板级"样本**

---

## 第二步：v4 模型训练

### 2.1 SoVITS 训练（音色克隆）
| 参数 | 推荐值 |
|------|--------|
| Epoch | 8-10 |
| Batch Size | 16-24 |
| 学习率 | 1e-4 |

### 2.2 GPT 训练（语调表现力）
| 参数 | 推荐值 |
|------|--------|
| Epoch | 15-20 |
| DPO | ✅ 开启 |
| Batch Size | 12-16 |

### 2.3 双卡并行策略
- **卡 0**: SoVITS 训练
- **卡 1**: GPT 训练 / 推理测试

---

## 第三步：推理配置

### 3.1 推理参数
| 参数 | 推荐值 |
|------|--------|
| Top_P | 0.8 |
| Temperature | 0.5-0.7 |
| 切分逻辑 | 凑四句一切 |

### 3.2 参考音频选择
- **时长**: 3-5s (黄金长度)
- **情感匹配**: 参考音频情感必须与目标文本一致
- **无吞音**: 清晰度优先

---

## 第四步：后处理（可选）

- **AudioSR**: 将 32kHz 提升至 48kHz
- **动态压缩**: Audacity 加轻微 Compressor

---

## v4 相比 v2 的优势

1. **辅音处理**: 摩擦音（s, ch, sh）更清晰
2. **长句连贯性**: 语气过渡更自然
3. **底模更强**: 需要更少的训练轮次

---

## 当前进度

## 第五步：调音台 WebUI (推荐)

### 5.1 启动方式
```bash
# 激活环境
conda activate Aoduo

# 启动纯血 v4 调音台
python /mnt/t2-6tb/Linpeikai/Voice/ATRI/atri_tuning_console.py
```

### 5.2 核心旋钮
| 旋钮 | 作用 | 推荐 |
|------|------|------|
| **Temp** | 情感波动 | 0.5-0.7 |
| **Top_P** | 自由度 | 0.8 |
| **Speed** | 语速 | 0.95 |

### 5.3 情感预设 (Preset)
调音台内置了 **Happy / Sad / Proud / Shy** 等 9 种预设。
**选择情感后，所有旋钮会自动跳变到最佳参数。**

---

## 当前进度

- [x] 数据集已准备 (2154 条音频)
- [x] 情感分类参考库 (`reference_library.json`)
- [x] v4 Vocoder 已下载
- [x] **训练 v4 SoVITS** (Finished)
- [x] **训练 v4 GPT** (Finished)
- [x] **全功能调音台** (WebUI Ready)
